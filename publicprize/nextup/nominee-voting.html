{% extends base_template %}
{%- import "layout/macros.html" as macros %}

{%- block subtitle %}Who's Next Up?{%- endblock %}

{%- block contest_content_class %}pp-nominees{%- endblock %}

{%- macro vote_button_class(nominee) %}
  {%- if user_vote and user_vote.nominee == nominee.biv_id -%}
    btn-primary disabled
  {%- else -%}
    btn-default
  {%- endif %}
{%- endmacro %}

{%- block jumbo_header %}
<div class="pp-jumbo-bg"></div>
<div class="container">
  <div class="row">
    <div class="pp-nextup-logo">
      <img src="/static/img/nextup-logo.jpg" alt="Next Up">
    </div>
    <div class="pp-jumbo-text">
      <h1>Who Will Be The Next Tech Startup Success Story?</h1>
    </div>
  </div>
</div>
{% endblock %}

{%- block contest_content %}
<div class="col-sm-1 hidden-xs">
  <img style="width:100%" src="/static/img/nextuparrow-87x80.png"
       alt="Arrow">
</div>
<div class="col-sm-7">
  <div class="lead">
    Next Up is an awards platform recognizing emerging technology
    companies most likely to be the next great success story of the
    Denver/Boulder technology scene.
  </div>
  <div class="pp-media-body">
    <p>Winners will be announced on this website on June 15th.</p>
  </div>
  <div class="pp-bottom-border hidden-xs"></div>
  <a id="vote"></a>
  <div class="pp-media-body">
    <h1>Vote For a Pint and a Pitcher</h1>
    <p>
      You may cast your vote for one <strong>Pint</strong> and
      one <strong>Pitcher</strong>. You can change your vote
      at any time. Voting ends on <b>June 10, 2015</b>.
    </p>
  </div>
  {{ pint_pitcher_tabs('vote') }}
  <div class="pp-tab-page">
    {%- for nominee in contest.get_public_nominees(category=category) %}
    <div class="lead">
      <a class="btn {{ vote_button_class(nominee) }} pp-vote-button" href="{{ nominee.format_uri('user-vote') }}"><span class="glyphicon glyphicon-triangle-top"></span><br/>{{ nominee.get_vote_count() }}</a>
      <a href="{{ nominee.url }}" target="_blank">{{ nominee.display_name }}</a>
    </div>
    {%- endfor %}
  </div>
</div>
{{- macros.signin_modal('pp_vote_modal', 'Sign in to vote') }}

{%- endblock %}

{%- block scripts %}
  {{- super() }}
  {%- if not session.get('user.is_logged_in') %}
    <script>
$(function() {
  $('.pp-vote-button').click(function() {
    var next = $(this).attr('href');
    $('#pp_vote_modal .pp-login-link').each(function(index, value) {
      value.href = value.href.replace(/\?.*/, '') + '?next=' + next;
    });
    $('#pp_vote_modal').modal('show');
    return false;
  });
});
    </script>
  {%- endif %}
{%- endblock %}
