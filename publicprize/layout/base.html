<!DOCTYPE html>
<html lang="en">
  <head>
    {% block head %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" type="image/png" href="/static/img/favicon.png">
    <title>{% block title %}{% endblock %} - Public Prize</title>
    <link href="/static/css/bootstrap-3.2.0.min.css" rel="stylesheet">
    <link href="/static/css/pp.css" rel="stylesheet">
    <!--[if IE 10]>
      <script src="/static/js/msie/ie10-viewport-bug-workaround.js"></script>
    <![endif]-->
    <!--[if lt IE 9]>
      <script src="/static/js/msie/html5shiv.min.js"></script>
      <script src="/static/js/msie/respond.min.js"></script>
    <![endif]-->
    {% endblock %}
  </head>

  <body>
    <div class="pp-masthead">
      {% block masthead %}
      <div class="container">
    	<nav class="pp-nav">
      	  <a class="pp-nav-logo" href="/"><img src="/static/img/logo.gif" alt="PUBLIC PRIZE"></a>
      	  <div class="pp-nav-menu pull-right">

	    {% if request.environ['beaker.session'].get('user.is_logged_in') %}

    	    {#- TODO(pjm): hard-coded general name #}		  
            <a class="pp-nav-item" href="/index/logout">Log out</a>

	    {% elif request.environ['beaker.session'].get('user.biv_id') %}

    	    {#- TODO(pjm): hard-coded general name #}
	    <form class="navbar-form" method="get" action="/index/facebook-login">
	    	<button class="btn btn-primary btn-sm"><img src="/static/img/facebook.png" alt="Facebook"> Log in with Facebook</button>
	    </form>
	    
	    {% else %}

            <a class="pp-nav-item" data-toggle="modal" data-target="#signupModal" href="#">Sign up</a>
            <a class="pp-nav-item" data-toggle="modal" data-target="#loginModal" href="#">Log in</a>

	    {% endif %}
      	  </div>
    	</nav>
      </div>
      {% endblock %}
    </div>
    
    <div class="container pp-content">{% block content %}{% endblock %}</div>

    <div class="pp-footer">
      {% block footer %}
      <div class="container">
        <div class="row">
          <div class="pull-left">
            <span class="pp-footer-item"><a href="#">Terms of Use</a></span>
            <span class="pp-footer-item"><a href="#">Privacy Policy</a></span>
            <span class="pp-footer-item"><a href="#">Support</a></span>
          </div>
        </div>
      </div>
      {% endblock %}
    </div>

    {% macro modal(id, heading_text, button_text) -%}
    
    <div class="modal fade" id="{{ id }}" tabindex="-1" role="dialog">
    	<div class="modal-dialog">
      	    <div class="modal-content">
      	    	<div class="modal-header">
	            <button type="button" class="close" data-dismiss="modal"><spanx>&times;</span></button>
	            <h4 class="modal-title">{{ heading_text }}</h4>
	      	</div>
            	<div class="pp-login-body modal-body">
    	    	    {#- TODO(pjm): hard-coded general name #}		  
		    <a href="/index/facebook-login" class="btn btn-primary btn-lg btn-block"><img src="/static/img/facebook.png" alt="Facebook"> {{ button_text }}</a>
            	</div>
      	    </div>
    	</div>
    </div>

    {%- endmacro -%}
    
    {{ modal('signupModal', 'Sign up', 'Sign up using Facebook') }}
    {{ modal('loginModal', 'Log in', 'Log in with Facebook') }}

    {% block scripts %}

    <script src="/static/js/jquery/jquery-1.11.1.min.js"></script>
    <script src="/static/js/bootstrap/bootstrap-3.2.0.min.js"></script>
    <script src="/static/js/pp-app.js"></script>
    {% endblock %}
  </body>
</html>
